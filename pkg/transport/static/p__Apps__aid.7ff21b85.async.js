(self.webpackChunkidas_ui=self.webpackChunkidas_ui||[]).push([[326],{12144:function(oe,F,n){"use strict";n.r(F),n.d(F,{default:function(){return Ie}});var D=n(18106),I=n(58500),H=n(49111),j=n(19650),$=n(93224),R=n(58024),c=n(91894),C=n(11849),A=n(57663),a=n(71577),i=n(62350),r=n(24565),e=n(2824),t=n(39428),l=n(34792),v=n(48086),T=n(3182),M=n(30381),O=n.n(M),p=n(67294),z=n(21010),K=n(44728),Y=n(14300),J=n(88293),ue=n(93400),Te=n(28508),Ze=n(55997),be=n(4582),Ve=n(71194),Ce=n(34883),ze=n(71153),de=n(60331),Je=n(47673),De=n(28166),s=n(85893),we=function(x){var w=x.visible,L=x.onClose,Z=x.app,Q=x.parentIntl,d=new ue.f("keypair.form",Q),X=(0,p.useState)(!1),q=(0,e.Z)(X,2),W=q[0],G=q[1],ne=(0,p.useState)(),_=(0,e.Z)(ne,2),k=_[0],V=_[1],m=(0,p.useState)(""),ee=(0,e.Z)(m,2),o=ee[0],N=ee[1];return(0,p.useEffect)(function(){w&&Z&&(G(!1),V(void 0),N(""))},[Z,w]),(0,s.jsx)(s.Fragment,{children:(0,s.jsxs)(Ce.Z,{title:k?d.t("title.success","Success"):d.t("title","Add App Key"),open:w,onCancel:L,cancelButtonProps:{hidden:Boolean(k)},onOk:(0,T.Z)((0,t.Z)().mark(function B(){var U;return(0,t.Z)().wrap(function(S){for(;;)switch(S.prev=S.next){case 0:if(!(Z!=null&&Z.id&&!W)){S.next=12;break}if(o){S.next=4;break}return v.default.error(d.t("name.empty","please input name!")),S.abrupt("return");case 4:return S.next=6,(0,K.Wo)({appId:Z.id},{name:o,appId:Z.id});case 6:if(U=S.sent,!U.success){S.next=11;break}return V(U.data),G(!0),S.abrupt("return");case 11:return S.abrupt("return");case 12:L();case 13:case"end":return S.stop()}},B)})),children:[(0,s.jsx)(De.Z,{hidden:W,value:o,onChange:function(U){N(U.target.value)},required:!W,placeholder:d.t("name.placeholder","Please Input name or description of app key")}),k&&(0,s.jsxs)("div",{children:[d.t("tips","App key pair, please keep it properly"),":",(0,s.jsxs)("ul",{style:{padding:"0px"},children:[(0,s.jsxs)("li",{children:["AccessKey: ",(0,s.jsx)(de.Z,{children:k.key})]}),(0,s.jsxs)("li",{children:["AccessSecret: ",(0,s.jsx)(de.Z,{children:k.secret})]})]})]})]})})},Le=we,xe=n(7717),je=["isDelete","createTime","updateTime"],Re=function(){var re=(0,T.Z)((0,t.Z)().mark(function x(w,L){var Z;return(0,t.Z)().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:if(!(!w||!L)){d.next=2;break}return d.abrupt("return",!0);case 2:return Z=v.default.loading("Deleting ..."),d.prev=3,d.next=6,(0,K.Rk)({appId:L},{appId:L,id:w});case 6:return Z(),v.default.success("Deleted successfully and will refresh soon"),d.abrupt("return",!0);case 11:return d.prev=11,d.t0=d.catch(3),Z(),v.default.error("Delete failed, please try again"),d.abrupt("return",!1);case 16:case"end":return d.stop()}},x,null,[[3,11]])}));return function(w,L){return re.apply(this,arguments)}}(),Pe=function(x){var w,L=x.match.params.aid,Z=x.history,Q=(0,p.useState)("baisc"),d=(0,e.Z)(Q,2),X=d[0],q=d[1],W=(0,p.useState)(),G=(0,e.Z)(W,2),ne=G[0],_=G[1],k=(0,p.useState)(),V=(0,e.Z)(k,2),m=V[0],ee=V[1],o=new ue.f("pages.apps",(0,z.YB)()),N=(0,p.useRef)(),B=(0,p.useRef)(),U=(0,p.useState)(!1),ae=(0,e.Z)(U,2),S=ae[0],se=ae[1],Ae=(0,p.useState)([]),ce=(0,e.Z)(Ae,2),pe=ce[0],Me=ce[1],Oe=(0,p.useState)([]),fe=(0,e.Z)(Oe,2),ie=fe[0],he=fe[1],Ke=(0,p.useState)(!1),ve=(0,e.Z)(Ke,2),Ye=ve[0],me=ve[1],ke=(0,p.useState)(!1),ye=(0,e.Z)(ke,2),ge=ye[0],le=ye[1],Be=(0,p.useState)(!1),Se=(0,e.Z)(Be,2),Ue=Se[0],Ee=Se[1],Fe=function(){return pe.map(function(u){var f=u.id,y=u.name,b=u.isDefault,h=u.urls;return{id:f,name:y,isDefault:b,urls:h}})},Ne=[{title:o.t("name.label","Name"),dataIndex:"name"},{title:o.t("description.label","Description"),dataIndex:"description",span:2,ellipsis:!0,contentStyle:{display:"contents"}},{title:o.t("displayName.label","Display Name"),dataIndex:"displayName"},{title:o.t("url.label","URL"),dataIndex:"url",span:2,copyable:!0,render:function(u,f){return(0,s.jsx)("a",{target:"_blank",href:f.url,rel:"noreferrer",children:u})},ellipsis:!0,contentStyle:{display:"contents"}},{title:o.t("grantType.label","Grant Type"),dataIndex:"grantType",valueEnum:(0,J.fs)(Y.qJ,o,"grantType.value")},{title:o.t("title.grantMode","Grant Mode"),dataIndex:"grantMode",valueEnum:(0,J.fs)(Y.FQ,o,"grantMode.value")}],He=function(){var E=(0,T.Z)((0,t.Z)().mark(function u(){var f,y;return(0,t.Z)().wrap(function(h){for(;;)switch(h.prev=h.next){case 0:return h.prev=0,me(!0),h.next=4,(0,K.BN)({id:L});case 4:return f=h.sent,f.data&&(y=f.data,ee(y),Me(y.roles?y.roles:[]),he(y.users?y.users:[])),B.current.reload(),me(!1),h.abrupt("return",f);case 11:return h.prev=11,h.t0=h.catch(0),h.t0.handled||console.error("failed to get app info: ".concat(h.t0)),h.abrupt("return",{success:!1});case 15:case"end":return h.stop()}},u,null,[[0,11]])}));return function(){return E.apply(this,arguments)}}(),$e=[{title:o.t("keypair.title.name","Name"),dataIndex:"name",ellipsis:!0},{title:o.t("keypair.title.key","Key"),dataIndex:"key",ellipsis:!0},{title:o.t("keypair.title.createTime","Create Time"),dataIndex:"createTime",width:200,render:function(u,f){return O()(f.createTime).locale(o.locale).format("LLL")}},{width:40,render:function(u,f){return[(0,s.jsx)(r.Z,{title:o.t("keypair.delete.popconfirm","Are you sure you want to delete the key named {name}? After deletion, the service cannot be accessed using this key pair.",void 0,{name:f.name}),onConfirm:(0,T.Z)((0,t.Z)().mark(function y(){var b;return(0,t.Z)().wrap(function(P){for(;;)switch(P.prev=P.next){case 0:return P.next=2,Re(f.id,f.appId);case 2:if(!P.sent){P.next=4;break}(b=B.current)===null||b===void 0||b.reload();case 4:case"end":return P.stop()}},y)})),children:(0,s.jsx)("a",{children:(0,s.jsx)(Te.Z,{})})},"delete")]}}],We=[{label:o.t("title.basic","Basic Info"),key:"basic",children:(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(Ze.ZP,{column:{xs:1,sm:2,md:3},actionRef:N,request:He,columns:Ne}),(0,s.jsx)(c.Z,{bodyStyle:{padding:0},headStyle:{padding:0},title:(0,s.jsx)("b",{children:o.t("title.keys","Key-pairs")}),bordered:!1,extra:(0,s.jsx)(a.Z,{type:"primary",onClick:function(){Ee(!0)},children:o.t("button.create-key","Create Key-pair")}),children:(0,s.jsx)(be.Z,{actionRef:B,toolBarRender:!1,request:function(u){return(0,K.qy)((0,C.Z)((0,C.Z)({},u),{},{appId:L}))},columns:$e,rowKey:"id",search:!1})})]})},{label:o.t("users","User"),key:"users",children:(0,s.jsx)("div",{style:{height:"calc( 100vh - 300px )"},children:(0,s.jsx)(xe.DV,{users:ie,roles:pe,onChange:he,loading:Ye,granting:S,parentIntl:o,type:"horizontal"})})},{label:o.t("proxy","Proxy"),key:"proxy",disabled:!((w=m==null?void 0:m.grantType)!==null&&w!==void 0?w:[]).includes(Y.qJ.proxy),children:(0,s.jsx)("div",{style:{height:"calc( 100vh - 320px )"},children:"111"})}],Ge=function(){var E=(0,T.Z)((0,t.Z)().mark(function u(f){var y,b,h,P,te;return(0,t.Z)().wrap(function(g){for(;;)switch(g.prev=g.next){case 0:if(!m){g.next=19;break}return g.prev=1,le(!0),y=m.isDelete,b=m.createTime,h=m.updateTime,P=(0,$.Z)(m,je),g.next=6,(0,K.KT)({id:L},(0,C.Z)((0,C.Z)({},P),{},{roles:Fe()},f));case 6:return te=g.sent,te.errorMessage&&v.default.error("failed to update: ".concat(te.errorMessage)),v.default.info("Successfully updated app information."),le(!1),g.abrupt("return",te);case 13:g.prev=13,g.t0=g.catch(1),g.t0.handled||console.error("failed to get user list: ".concat(g.t0));case 16:return g.prev=16,le(!1),g.finish(16);case 19:return g.abrupt("return",{success:!1});case 20:case"end":return g.stop()}},u,null,[[1,13,16,19]])}));return function(f){return E.apply(this,arguments)}}();return(0,p.useEffect)(function(){var E=[(0,s.jsx)(a.Z,{hidden:!(m!=null&&m.id),type:"primary",onClick:function(){return Z.push("/apps/".concat(m==null?void 0:m.id,"/edit"))},children:"Edit"},"edit"),(0,s.jsx)(a.Z,{type:"primary",onClick:function(){return N.current.reload()},children:"Refresh"},"refresh")];X==="users"&&(S?E=[(0,s.jsx)(a.Z,{type:"primary",onClick:(0,T.Z)((0,t.Z)().mark(function u(){return(0,t.Z)().wrap(function(y){for(;;)switch(y.prev=y.next){case 0:Ge({users:ie.map(function(b){return{id:b.id,roleId:b.roleId}})}).then(function(b){b.success&&(se(!1),N.current.reload())});case 1:case"end":return y.stop()}},u)})),loading:ge,children:"Save"},"save"),(0,s.jsx)(a.Z,{type:"link",onClick:function(){return se(!1)},children:"Cancel"},"cancel")]:E.push((0,s.jsx)(a.Z,{type:"primary",onClick:function(){return se(!0)},children:"Grant"}))),_(E)},[X,S,ie,ge]),(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(c.Z,{style:{height:"100%"},bodyStyle:{height:"100%"},children:(0,s.jsx)(I.Z,{items:We,onChange:function(u){q(u)},tabBarExtraContent:(0,s.jsx)(j.Z,{children:ne})})}),(0,s.jsx)(Le,{visible:Ue,app:m,onClose:function(){Ee(!1),B.current.reload()},parentIntl:o})]})},Ie=Pe},34952:function(oe,F,n){"use strict";var D=n(22122),I=n(15105),H=n(67294),j=function(c,C){var A={};for(var a in c)Object.prototype.hasOwnProperty.call(c,a)&&C.indexOf(a)<0&&(A[a]=c[a]);if(c!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,a=Object.getOwnPropertySymbols(c);i<a.length;i++)C.indexOf(a[i])<0&&Object.prototype.propertyIsEnumerable.call(c,a[i])&&(A[a[i]]=c[a[i]]);return A},$={border:0,background:"transparent",padding:0,lineHeight:"inherit",display:"inline-block"},R=H.forwardRef(function(c,C){var A=function(T){var M=T.keyCode;M===I.Z.ENTER&&T.preventDefault()},a=function(T){var M=T.keyCode,O=c.onClick;M===I.Z.ENTER&&O&&O()},i=c.style,r=c.noStyle,e=c.disabled,t=j(c,["style","noStyle","disabled"]),l={};return r||(l=(0,D.Z)({},$)),e&&(l.pointerEvents="none"),l=(0,D.Z)((0,D.Z)({},l),i),H.createElement("div",(0,D.Z)({role:"button",tabIndex:0,ref:C},t,{onKeyDown:A,onKeyUp:a,style:l}))});F.Z=R},58533:function(oe,F,n){"use strict";var D=n(67294);/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */var I=function(a,i){return I=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,e){r.__proto__=e}||function(r,e){for(var t in e)e.hasOwnProperty(t)&&(r[t]=e[t])},I(a,i)};function H(a,i){I(a,i);function r(){this.constructor=a}a.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}var j=function(){return j=Object.assign||function(i){for(var r,e=1,t=arguments.length;e<t;e++){r=arguments[e];for(var l in r)Object.prototype.hasOwnProperty.call(r,l)&&(i[l]=r[l])}return i},j.apply(this,arguments)};function $(a,i,r,e){var t,l=!1,v=0;function T(){t&&clearTimeout(t)}function M(){T(),l=!0}typeof i!="boolean"&&(e=r,r=i,i=void 0);function O(){var p=this,z=Date.now()-v,K=arguments;if(l)return;function Y(){v=Date.now(),r.apply(p,K)}function J(){t=void 0}e&&!t&&Y(),T(),e===void 0&&z>a?Y():i!==!0&&(t=setTimeout(e?J:Y,e===void 0?a-z:a))}return O.cancel=M,O}var R={Pixel:"Pixel",Percent:"Percent"},c={unit:R.Percent,value:.8};function C(a){return typeof a=="number"?{unit:R.Percent,value:a*100}:typeof a=="string"?a.match(/^(\d*(\.\d+)?)px$/)?{unit:R.Pixel,value:parseFloat(a)}:a.match(/^(\d*(\.\d+)?)%$/)?{unit:R.Percent,value:parseFloat(a)}:(console.warn('scrollThreshold format is invalid. Valid formats: "120px", "50%"...'),c):(console.warn("scrollThreshold should be string or number"),c)}var A=function(a){H(i,a);function i(r){var e=a.call(this,r)||this;return e.lastScrollTop=0,e.actionTriggered=!1,e.startY=0,e.currentY=0,e.dragging=!1,e.maxPullDownDistance=0,e.getScrollableTarget=function(){return e.props.scrollableTarget instanceof HTMLElement?e.props.scrollableTarget:typeof e.props.scrollableTarget=="string"?document.getElementById(e.props.scrollableTarget):(e.props.scrollableTarget===null&&console.warn(`You are trying to pass scrollableTarget but it is null. This might
        happen because the element may not have been added to DOM yet.
        See https://github.com/ankeetmaini/react-infinite-scroll-component/issues/59 for more info.
      `),null)},e.onStart=function(t){e.lastScrollTop||(e.dragging=!0,t instanceof MouseEvent?e.startY=t.pageY:t instanceof TouchEvent&&(e.startY=t.touches[0].pageY),e.currentY=e.startY,e._infScroll&&(e._infScroll.style.willChange="transform",e._infScroll.style.transition="transform 0.2s cubic-bezier(0,0,0.31,1)"))},e.onMove=function(t){!e.dragging||(t instanceof MouseEvent?e.currentY=t.pageY:t instanceof TouchEvent&&(e.currentY=t.touches[0].pageY),!(e.currentY<e.startY)&&(e.currentY-e.startY>=Number(e.props.pullDownToRefreshThreshold)&&e.setState({pullToRefreshThresholdBreached:!0}),!(e.currentY-e.startY>e.maxPullDownDistance*1.5)&&e._infScroll&&(e._infScroll.style.overflow="visible",e._infScroll.style.transform="translate3d(0px, "+(e.currentY-e.startY)+"px, 0px)")))},e.onEnd=function(){e.startY=0,e.currentY=0,e.dragging=!1,e.state.pullToRefreshThresholdBreached&&(e.props.refreshFunction&&e.props.refreshFunction(),e.setState({pullToRefreshThresholdBreached:!1})),requestAnimationFrame(function(){e._infScroll&&(e._infScroll.style.overflow="auto",e._infScroll.style.transform="none",e._infScroll.style.willChange="unset")})},e.onScrollListener=function(t){typeof e.props.onScroll=="function"&&setTimeout(function(){return e.props.onScroll&&e.props.onScroll(t)},0);var l=e.props.height||e._scrollableNode?t.target:document.documentElement.scrollTop?document.documentElement:document.body;if(!e.actionTriggered){var v=e.props.inverse?e.isElementAtTop(l,e.props.scrollThreshold):e.isElementAtBottom(l,e.props.scrollThreshold);v&&e.props.hasMore&&(e.actionTriggered=!0,e.setState({showLoader:!0}),e.props.next&&e.props.next()),e.lastScrollTop=l.scrollTop}},e.state={showLoader:!1,pullToRefreshThresholdBreached:!1,prevDataLength:r.dataLength},e.throttledOnScrollListener=$(150,e.onScrollListener).bind(e),e.onStart=e.onStart.bind(e),e.onMove=e.onMove.bind(e),e.onEnd=e.onEnd.bind(e),e}return i.prototype.componentDidMount=function(){if(typeof this.props.dataLength=="undefined")throw new Error('mandatory prop "dataLength" is missing. The prop is needed when loading more content. Check README.md for usage');if(this._scrollableNode=this.getScrollableTarget(),this.el=this.props.height?this._infScroll:this._scrollableNode||window,this.el&&this.el.addEventListener("scroll",this.throttledOnScrollListener),typeof this.props.initialScrollY=="number"&&this.el&&this.el instanceof HTMLElement&&this.el.scrollHeight>this.props.initialScrollY&&this.el.scrollTo(0,this.props.initialScrollY),this.props.pullDownToRefresh&&this.el&&(this.el.addEventListener("touchstart",this.onStart),this.el.addEventListener("touchmove",this.onMove),this.el.addEventListener("touchend",this.onEnd),this.el.addEventListener("mousedown",this.onStart),this.el.addEventListener("mousemove",this.onMove),this.el.addEventListener("mouseup",this.onEnd),this.maxPullDownDistance=this._pullDown&&this._pullDown.firstChild&&this._pullDown.firstChild.getBoundingClientRect().height||0,this.forceUpdate(),typeof this.props.refreshFunction!="function"))throw new Error(`Mandatory prop "refreshFunction" missing.
          Pull Down To Refresh functionality will not work
          as expected. Check README.md for usage'`)},i.prototype.componentWillUnmount=function(){this.el&&(this.el.removeEventListener("scroll",this.throttledOnScrollListener),this.props.pullDownToRefresh&&(this.el.removeEventListener("touchstart",this.onStart),this.el.removeEventListener("touchmove",this.onMove),this.el.removeEventListener("touchend",this.onEnd),this.el.removeEventListener("mousedown",this.onStart),this.el.removeEventListener("mousemove",this.onMove),this.el.removeEventListener("mouseup",this.onEnd)))},i.prototype.componentDidUpdate=function(r){this.props.dataLength!==r.dataLength&&(this.actionTriggered=!1,this.setState({showLoader:!1}))},i.getDerivedStateFromProps=function(r,e){var t=r.dataLength!==e.prevDataLength;return t?j(j({},e),{prevDataLength:r.dataLength}):null},i.prototype.isElementAtTop=function(r,e){e===void 0&&(e=.8);var t=r===document.body||r===document.documentElement?window.screen.availHeight:r.clientHeight,l=C(e);return l.unit===R.Pixel?r.scrollTop<=l.value+t-r.scrollHeight+1:r.scrollTop<=l.value/100+t-r.scrollHeight+1},i.prototype.isElementAtBottom=function(r,e){e===void 0&&(e=.8);var t=r===document.body||r===document.documentElement?window.screen.availHeight:r.clientHeight,l=C(e);return l.unit===R.Pixel?r.scrollTop+t>=r.scrollHeight-l.value:r.scrollTop+t>=l.value/100*r.scrollHeight},i.prototype.render=function(){var r=this,e=j({height:this.props.height||"auto",overflow:"auto",WebkitOverflowScrolling:"touch"},this.props.style),t=this.props.hasChildren||!!(this.props.children&&this.props.children instanceof Array&&this.props.children.length),l=this.props.pullDownToRefresh&&this.props.height?{overflow:"auto"}:{};return D.createElement("div",{style:l,className:"infinite-scroll-component__outerdiv"},D.createElement("div",{className:"infinite-scroll-component "+(this.props.className||""),ref:function(v){return r._infScroll=v},style:e},this.props.pullDownToRefresh&&D.createElement("div",{style:{position:"relative"},ref:function(v){return r._pullDown=v}},D.createElement("div",{style:{position:"absolute",left:0,right:0,top:-1*this.maxPullDownDistance}},this.state.pullToRefreshThresholdBreached?this.props.releaseToRefreshContent:this.props.pullDownToRefreshContent)),this.props.children,!this.state.showLoader&&!t&&this.props.hasMore&&this.props.loader,this.state.showLoader&&this.props.hasMore&&this.props.loader,!this.props.hasMore&&this.props.endMessage))},i}(D.Component);F.Z=A}}]);
