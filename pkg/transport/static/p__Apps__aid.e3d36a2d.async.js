(self.webpackChunkidas_ui=self.webpackChunkidas_ui||[]).push([[326],{50317:function(fe){fe.exports={SearchInput:"SearchInput___PEFkt",ProxyUrlInput:"ProxyUrlInput___3liOo"}},44887:function(){},12144:function(fe,N,t){"use strict";t.r(N),t.d(N,{default:function(){return Me}});var j=t(18106),K=t(58500),re=t(49111),U=t(19650),J=t(93224),B=t(58024),h=t(91894),D=t(11849),F=t(57663),a=t(71577),o=t(62350),l=t(24565),e=t(71153),n=t(60331),i=t(2824),u=t(39428),M=t(34792),O=t(48086),C=t(3182),Ee=t(96486),ne=t(30381),_e=t.n(ne),v=t(67294),d=t(21010),se=t(44728),z=t(14300),Se=t(88293),Te=t(93400),w=t(28508),Q=t(55997),_=t(4582),ae=t(71194),G=t(34883),De=t(17462),he=t(76772),ve=t(47673),V=t(28166),r=t(85893),le=function(x){var A=x.visible,b=x.onClose,Z=x.app,me=x.parentIntl,p=new Te.f("keypair.form",me),ue=(0,v.useState)(!1),de=(0,i.Z)(ue,2),q=de[0],ce=de[1],ye=(0,v.useState)(),ee=(0,i.Z)(ye,2),W=ee[0],te=ee[1],m=(0,v.useState)(""),Y=(0,i.Z)(m,2),s=Y[0],H=Y[1];return(0,v.useEffect)(function(){A&&Z&&(ce(!1),te(void 0),H(""))},[Z,A]),(0,r.jsx)(r.Fragment,{children:(0,r.jsxs)(G.Z,{title:W?p.t("title.success","Success"):p.t("title","Add App Key"),open:A,onCancel:b,cancelButtonProps:{hidden:Boolean(W)},onOk:(0,C.Z)((0,u.Z)().mark(function L(){var $;return(0,u.Z)().wrap(function(E){for(;;)switch(E.prev=E.next){case 0:if(!(Z!=null&&Z.id&&!q)){E.next=12;break}if(s){E.next=4;break}return O.default.error(p.t("name.empty","please input name!")),E.abrupt("return");case 4:return E.next=6,(0,se.Wo)({appId:Z.id},{name:s,appId:Z.id});case 6:if($=E.sent,!$.success){E.next=11;break}return te($.data),ce(!0),E.abrupt("return");case 11:return E.abrupt("return");case 12:b();case 13:case"end":return E.stop()}},L)})),children:[(0,r.jsx)(V.Z,{hidden:q,value:s,onChange:function($){H($.target.value)},required:!q,placeholder:p.t("name.placeholder","Please Input name or description of app key")}),W&&(0,r.jsxs)("div",{children:[(0,r.jsx)(he.Z,{description:p.t("used.tips","If used for applications such as OAuth, please use Access Secret. If used for radius, please use Secret Hash."),type:"info",showIcon:!0}),p.t("tips","App key pair, please keep it properly."),":",(0,r.jsxs)("ul",{style:{padding:"0px"},children:[(0,r.jsxs)("li",{children:["Access Key: ",(0,r.jsx)(n.Z,{children:W.key})]}),(0,r.jsxs)("li",{children:["Access Secret: ",(0,r.jsx)(n.Z,{children:W.privateKey})]}),(0,r.jsxs)("li",{children:["Secret Hash: ",(0,r.jsx)(n.Z,{children:W.secret})]})]})]})]})})},ie=le,I=t(7717),oe=["isDelete","createTime","updateTime"],X=function(){var Pe=(0,C.Z)((0,u.Z)().mark(function x(A,b){var Z;return(0,u.Z)().wrap(function(p){for(;;)switch(p.prev=p.next){case 0:if(!(!A||!b)){p.next=2;break}return p.abrupt("return",!0);case 2:return Z=O.default.loading("Deleting ..."),p.prev=3,p.next=6,(0,se.Rk)({appId:b},{appId:b,id:A});case 6:return Z(),O.default.success("Deleted successfully and will refresh soon"),p.abrupt("return",!0);case 11:return p.prev=11,p.t0=p.catch(3),Z(),O.default.error("Delete failed, please try again"),p.abrupt("return",!1);case 16:case"end":return p.stop()}},x,null,[[3,11]])}));return function(A,b){return Pe.apply(this,arguments)}}(),Le=function(x){var A,b=x.match.params.aid,Z=x.history,me=(0,v.useState)("baisc"),p=(0,i.Z)(me,2),ue=p[0],de=p[1],q=(0,v.useState)(),ce=(0,i.Z)(q,2),ye=ce[0],ee=ce[1],W=(0,v.useState)(),te=(0,i.Z)(W,2),m=te[0],Y=te[1],s=new Te.f("pages.apps",(0,d.YB)()),H=(0,v.useRef)(),L=(0,v.useRef)(),$=(0,v.useState)(!1),pe=(0,i.Z)($,2),E=pe[0],ge=pe[1],Ie=(0,v.useState)([]),S=(0,i.Z)(Ie,2),Ce=S[0],We=S[1],Ye=(0,v.useState)([]),be=(0,i.Z)(Ye,2),je=be[0],xe=be[1],Ne=(0,v.useState)(!1),Ae=(0,i.Z)(Ne,2),Fe=Ae[0],Re=Ae[1],He=(0,v.useState)(!1),Ke=(0,i.Z)(He,2),Ue=Ke[0],Oe=Ke[1],$e=(0,v.useState)(!1),Be=(0,i.Z)($e,2),ze=Be[0],we=Be[1],Ge=function(){return Ce.map(function(c){var f=c.id,y=c.name,R=c.isDefault,g=c.urls;return{id:f,name:y,isDefault:R,urls:g}})},Ve=[{title:s.t("name.label","Name"),dataIndex:"name"},{title:s.t("description.label","Description"),dataIndex:"description",span:2,ellipsis:!0,contentStyle:{display:"grid"}},{title:s.t("displayName.label","Display Name"),dataIndex:"displayName"},{title:s.t("url.label","URL"),dataIndex:"url",span:2,copyable:!0,render:function(c,f){return(0,r.jsx)("a",{target:"_blank",href:f.url,rel:"noreferrer",children:c})},ellipsis:!0,contentStyle:{display:"contents"}},{title:s.t("grantType.label","Grant Type"),dataIndex:"grantType",valueEnum:(0,Se.fs)(z.qJ,s,"grantType.value"),render:function(c,f){return(0,Ee.isArray)(f.grantType)?f.grantType.length>0?f.grantType.map(function(y){return(0,r.jsx)(n.Z,{children:s.formatMessage({id:"grantType.value.".concat(z.qJ[y]),defaultMessage:z.qJ[y]})},y)}):(0,r.jsx)(n.Z,{children:s.formatMessage({id:"grantType.value.".concat(z.qJ[0]),defaultMessage:z.qJ[0]})}):(0,r.jsx)(n.Z,{children:f.grantType})}},{title:s.t("title.grantMode","Grant Mode"),dataIndex:"grantMode",valueEnum:(0,Se.fs)(z.FQ,s,"grantMode.value")}],ke=function(){var P=(0,C.Z)((0,u.Z)().mark(function c(){var f,y;return(0,u.Z)().wrap(function(g){for(;;)switch(g.prev=g.next){case 0:return g.prev=0,Re(!0),g.next=4,(0,se.BN)({id:b});case 4:return f=g.sent,f.data&&(y=f.data,Y(y),We(y.roles?y.roles:[]),xe(y.users?y.users:[])),L.current.reload(),g.abrupt("return",f);case 10:return g.prev=10,g.t0=g.catch(0),g.t0.handled||console.error("failed to get app info: ".concat(g.t0)),g.abrupt("return",{success:!1});case 14:return g.prev=14,Re(!1),g.finish(14);case 17:case"end":return g.stop()}},c,null,[[0,10,14,17]])}));return function(){return P.apply(this,arguments)}}(),Je=[{title:s.t("keypair.title.name","Name"),dataIndex:"name",ellipsis:!0},{title:s.t("keypair.title.key","Key"),dataIndex:"key",ellipsis:!0},{title:s.t("keypair.title.createTime","Create Time"),dataIndex:"createTime",width:200,render:function(c,f){return _e()(f.createTime).locale(s.locale).format("LLL")}},{width:40,render:function(c,f){return[(0,r.jsx)(l.Z,{title:s.t("keypair.delete.popconfirm","Are you sure you want to delete the key named {name}? After deletion, the service cannot be accessed using this key pair.",void 0,{name:f.name}),onConfirm:(0,C.Z)((0,u.Z)().mark(function y(){var R;return(0,u.Z)().wrap(function(k){for(;;)switch(k.prev=k.next){case 0:return k.next=2,X(f.id,f.appId);case 2:if(!k.sent){k.next=4;break}(R=L.current)===null||R===void 0||R.reload();case 4:case"end":return k.stop()}},y)})),children:(0,r.jsx)("a",{children:(0,r.jsx)(w.Z,{})})},"delete")]}}],Qe=[{label:s.t("title.basic","Basic Info"),key:"basic",children:(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(Q.ZP,{column:{xs:1,sm:2,md:3},actionRef:H,request:ke,columns:Ve}),(0,r.jsx)(h.Z,{bodyStyle:{padding:0},headStyle:{padding:0},title:(0,r.jsx)("b",{children:s.t("title.keys","Key-pairs")}),bordered:!1,extra:(0,r.jsx)(a.Z,{type:"primary",onClick:function(){we(!0)},children:s.t("button.create-key","Create Key-pair")}),children:(0,r.jsx)(_.Z,{actionRef:L,toolBarRender:!1,request:function(c){return(0,se.qy)((0,D.Z)((0,D.Z)({},c),{},{appId:b}))},columns:Je,rowKey:"id",search:!1})})]})},{label:s.t("users","User"),key:"users",children:(0,r.jsx)("div",{style:{height:"calc( 100vh - 300px )"},children:(0,r.jsx)(I.DV,{users:je,roles:Ce,onChange:xe,loading:Fe,granting:E,parentIntl:s,type:"horizontal"})})},{label:s.t("proxy","Proxy"),key:"proxy",disabled:!((A=m==null?void 0:m.grantType)!==null&&A!==void 0?A:[]).includes(z.qJ.proxy),children:(0,r.jsx)("div",{style:{height:"calc( 100vh - 320px )"},children:"111"})}],Xe=function(){var P=(0,C.Z)((0,u.Z)().mark(function c(f){var y,R,g,k,Ze;return(0,u.Z)().wrap(function(T){for(;;)switch(T.prev=T.next){case 0:if(!m){T.next=19;break}return T.prev=1,Oe(!0),y=m.isDelete,R=m.createTime,g=m.updateTime,k=(0,J.Z)(m,oe),T.next=6,(0,se.KT)({id:b},(0,D.Z)((0,D.Z)({},k),{},{roles:Ge()},f));case 6:return Ze=T.sent,Ze.errorMessage&&O.default.error("failed to update: ".concat(Ze.errorMessage)),O.default.info("Successfully updated app information."),Oe(!1),T.abrupt("return",Ze);case 13:T.prev=13,T.t0=T.catch(1),T.t0.handled||console.error("failed to get user list: ".concat(T.t0));case 16:return T.prev=16,Oe(!1),T.finish(16);case 19:return T.abrupt("return",{success:!1});case 20:case"end":return T.stop()}},c,null,[[1,13,16,19]])}));return function(f){return P.apply(this,arguments)}}();return(0,v.useEffect)(function(){var P=[(0,r.jsx)(a.Z,{hidden:!(m!=null&&m.id),type:"primary",onClick:function(){return Z.push("/apps/".concat(m==null?void 0:m.id,"/edit"))},children:s.t("button.edit","Edit")},"edit"),(0,r.jsx)(a.Z,{type:"primary",onClick:function(){return H.current.reload()},children:s.t("button.refresh","Refresh")},"refresh")];ue==="users"&&(E?P=[(0,r.jsx)(a.Z,{type:"primary",onClick:(0,C.Z)((0,u.Z)().mark(function c(){return(0,u.Z)().wrap(function(y){for(;;)switch(y.prev=y.next){case 0:Xe({users:je.map(function(R){return{id:R.id,roleId:R.roleId}})}).then(function(R){R.success&&(ge(!1),H.current.reload())});case 1:case"end":return y.stop()}},c)})),loading:Ue,children:s.t("button.save","Save")},"save"),(0,r.jsx)(a.Z,{type:"link",onClick:function(){return ge(!1)},children:s.t("button.cancel","Cancel")},"cancel")]:P.push((0,r.jsx)(a.Z,{type:"primary",onClick:function(){return ge(!0)},children:s.t("button.grant","Grant")}))),ee(P)},[ue,E,je,Ue]),(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(h.Z,{style:{height:"100%"},bodyStyle:{height:"100%"},children:(0,r.jsx)(K.Z,{items:Qe,onChange:function(c){de(c)},tabBarExtraContent:(0,r.jsx)(U.Z,{children:ye})})}),(0,r.jsx)(ie,{visible:ze,app:m,onClose:function(){we(!1),L.current.reload()},parentIntl:s})]})},Me=Le},7717:function(fe,N,t){"use strict";t.d(N,{DV:function(){return Se}});var j=t(48736),K=t(27049),re=t(71748),U=t(90860),J=t(47673),B=t(28166),h=t(39428),D=t(86582),F=t(3182),a=t(2824),o=t(93224),l=t(43358),e=t(66074),n=t(11849),i=t(54421),u=t(38272),M=t(67294),O=t(58533),C=t(2844),Ee=t(10861),ne=t(93400),_e=t(50317),v=t.n(_e),d=t(85893),se=["type","loading"],z=function(w){var Q=w.users,_=w.onChange,ae=w.roles,G=w.loading,De=w.granting,he=w.parentIntl,ve=new ne.f("users",he);return(0,d.jsx)(u.ZP,{dataSource:Q,size:"small",loading:G,renderItem:function(r){var le,ie;return(0,d.jsxs)(u.ZP.Item,{actions:_&&De?[(0,d.jsx)("a",{onClick:function(){_(Q.filter(function(oe){return oe.id!=r.id}))},children:ve.t("userList.delete","Delete")},"grant")]:[],children:[(0,d.jsx)(u.ZP.Item.Meta,{avatar:(0,d.jsx)(C.ZP,{src:"".concat(r.avatar)}),title:r.fullName?r.fullName:r.username,description:r.email}),_&&De&&ae.length>0?(0,d.jsx)(e.Z,{onSelect:function(oe){_(Q.map(function(X){return X.id==r.id?(0,n.Z)((0,n.Z)({},X),{},{roleId:oe}):X}))},defaultValue:r&&r.roleId?r.roleId:(le=ae.find(function(I){return I.isDefault}))===null||le===void 0?void 0:le.id,options:ae.map(function(I){return{key:I.id,value:I.id,label:I.name}})}):(0,d.jsx)("div",{children:r&&r.role?r.role:(ie=ae.find(function(I){return I.isDefault}))===null||ie===void 0?void 0:ie.name})]},r.id)}})},Se=function(w){var Q=w.type,_=Q===void 0?"vertical":Q,ae=w.loading,G=(0,o.Z)(w,se),De=G.roles,he=G.onChange,ve=G.users,V=G.granting,r=G.parentIntl,le=new ne.f("grant",r),ie=(0,M.useState)(!0),I=(0,a.Z)(ie,2),oe=I[0],X=I[1],Le=(0,M.useState)(0),Me=(0,a.Z)(Le,2),Pe=Me[0],x=Me[1],A=(0,M.useState)(),b=(0,a.Z)(A,2),Z=b[0],me=b[1],p=(0,M.useState)([]),ue=(0,a.Z)(p,2),de=ue[0],q=ue[1],ce=(0,M.useState)(!1),ye=(0,a.Z)(ce,2),ee=ye[0],W=ye[1],te=function(){var Y=(0,F.Z)((0,h.Z)().mark(function s(H){var L,$,pe,E,ge;return(0,h.Z)().wrap(function(S){for(;;)switch(S.prev=S.next){case 0:return S.prev=0,W(!0),S.next=4,(0,Ee.Rf)((0,n.Z)({current:Pe+1,pageSize:20,keywords:Z},H));case 4:L=S.sent,L&&L.data?($=L.data,pe=L.current,E=L.pageSize,ge=L.total,q(function(Ce){return[].concat((0,D.Z)(Ce),(0,D.Z)($))}),x(pe),ge<pe*E&&X(!1)):X(!1),S.next=11;break;case 8:S.prev=8,S.t0=S.catch(0),S.t0.handled||console.error("failed to get user list: ".concat(S.t0));case 11:return S.prev=11,W(!1),S.finish(11);case 14:case"end":return S.stop()}},s,null,[[0,8,11,14]])}));return function(H){return Y.apply(this,arguments)}}(),m=function(s){q([]),me(s),x(1),te({keywords:s,current:1})};return(0,M.useEffect)(function(){m()},[]),(0,d.jsxs)("div",{style:{height:"100%",width:"100%"},children:[V&&(0,d.jsxs)(d.Fragment,{children:[(0,d.jsxs)("div",{style:{height:_==="vertical"?"calc(100% / 2)":"100%",display:V?"block":"none",width:_==="vertical"?"100%":"calc((100% - 32px) / 2)",float:_==="horizontal"?"left":"unset"},children:[(0,d.jsx)(B.Z.Search,{className:v().SearchInput,onSearch:function(s){ee||m(s)},loading:ee}),(0,d.jsx)("div",{id:"scrollableDiv",style:{height:"calc( 100% - 32px )",overflow:"auto",padding:"0 16px",border:"1px solid rgba(140, 140, 140, 0.35)"},children:(0,d.jsx)(O.Z,{dataLength:de.length,next:te,hasMore:oe,loader:(0,d.jsx)(U.Z,{avatar:!0,paragraph:{rows:1},active:!0}),endMessage:(0,d.jsx)(K.Z,{plain:!0,children:"End"}),scrollableTarget:"scrollableDiv",children:(0,d.jsx)(u.ZP,{dataSource:de.filter(function(Y){return!ve.map(function(s){return s.id}).includes(Y.id)}),size:"small",loading:ee,renderItem:function(s){return(0,d.jsx)(u.ZP.Item,{actions:[(0,d.jsx)("a",{onClick:function(){he([].concat((0,D.Z)(ve),[(0,n.Z)((0,n.Z)({},s),{},{role:""})]))},children:le.t("userList.grant","Grant")},"grant")],children:(0,d.jsx)(u.ZP.Item.Meta,{avatar:(0,d.jsx)(C.ZP,{src:"".concat(s.avatar)}),title:s.fullName?s.fullName:s.username,description:s.email})},s.id)}})})})]}),(0,d.jsx)(K.Z,{type:_==="vertical"?"horizontal":"vertical",style:{height:_==="vertical"?"unset":"100%",margin:_==="vertical"?"10px 0":"0 10px",float:_==="horizontal"?"left":"unset",display:V?"":"none"}})]}),(0,d.jsx)("div",{id:"scrollableDiv",style:{height:_!=="vertical"||!V?"100%":"calc((100% - 42px) / 2)",width:_==="horizontal"&&V?"calc((100% - 32px) / 2)":"100%",overflow:"auto",padding:"0 16px",float:_==="horizontal"?"left":"unset",border:"1px solid rgba(140, 140, 140, 0.35)"},children:(0,d.jsx)(z,{parentIntl:r,users:ve,granting:V,roles:De,loading:ae,onChange:he})})]})};N.ZP=Se},34952:function(fe,N,t){"use strict";var j=t(22122),K=t(15105),re=t(67294),U=function(h,D){var F={};for(var a in h)Object.prototype.hasOwnProperty.call(h,a)&&D.indexOf(a)<0&&(F[a]=h[a]);if(h!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,a=Object.getOwnPropertySymbols(h);o<a.length;o++)D.indexOf(a[o])<0&&Object.prototype.propertyIsEnumerable.call(h,a[o])&&(F[a[o]]=h[a[o]]);return F},J={border:0,background:"transparent",padding:0,lineHeight:"inherit",display:"inline-block"},B=re.forwardRef(function(h,D){var F=function(M){var O=M.keyCode;O===K.Z.ENTER&&M.preventDefault()},a=function(M){var O=M.keyCode,C=h.onClick;O===K.Z.ENTER&&C&&C()},o=h.style,l=h.noStyle,e=h.disabled,n=U(h,["style","noStyle","disabled"]),i={};return l||(i=(0,j.Z)({},J)),e&&(i.pointerEvents="none"),i=(0,j.Z)((0,j.Z)({},i),o),re.createElement("div",(0,j.Z)({role:"button",tabIndex:0,ref:D},n,{onKeyDown:F,onKeyUp:a,style:i}))});N.Z=B},62350:function(fe,N,t){"use strict";var j=t(38663),K=t.n(j),re=t(57663),U=t(20136),J=t(44887),B=t.n(J)},58533:function(fe,N,t){"use strict";var j=t(67294);/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */var K=function(a,o){return K=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(l,e){l.__proto__=e}||function(l,e){for(var n in e)e.hasOwnProperty(n)&&(l[n]=e[n])},K(a,o)};function re(a,o){K(a,o);function l(){this.constructor=a}a.prototype=o===null?Object.create(o):(l.prototype=o.prototype,new l)}var U=function(){return U=Object.assign||function(o){for(var l,e=1,n=arguments.length;e<n;e++){l=arguments[e];for(var i in l)Object.prototype.hasOwnProperty.call(l,i)&&(o[i]=l[i])}return o},U.apply(this,arguments)};function J(a,o,l,e){var n,i=!1,u=0;function M(){n&&clearTimeout(n)}function O(){M(),i=!0}typeof o!="boolean"&&(e=l,l=o,o=void 0);function C(){var Ee=this,ne=Date.now()-u,_e=arguments;if(i)return;function v(){u=Date.now(),l.apply(Ee,_e)}function d(){n=void 0}e&&!n&&v(),M(),e===void 0&&ne>a?v():o!==!0&&(n=setTimeout(e?d:v,e===void 0?a-ne:a))}return C.cancel=O,C}var B={Pixel:"Pixel",Percent:"Percent"},h={unit:B.Percent,value:.8};function D(a){return typeof a=="number"?{unit:B.Percent,value:a*100}:typeof a=="string"?a.match(/^(\d*(\.\d+)?)px$/)?{unit:B.Pixel,value:parseFloat(a)}:a.match(/^(\d*(\.\d+)?)%$/)?{unit:B.Percent,value:parseFloat(a)}:(console.warn('scrollThreshold format is invalid. Valid formats: "120px", "50%"...'),h):(console.warn("scrollThreshold should be string or number"),h)}var F=function(a){re(o,a);function o(l){var e=a.call(this,l)||this;return e.lastScrollTop=0,e.actionTriggered=!1,e.startY=0,e.currentY=0,e.dragging=!1,e.maxPullDownDistance=0,e.getScrollableTarget=function(){return e.props.scrollableTarget instanceof HTMLElement?e.props.scrollableTarget:typeof e.props.scrollableTarget=="string"?document.getElementById(e.props.scrollableTarget):(e.props.scrollableTarget===null&&console.warn(`You are trying to pass scrollableTarget but it is null. This might
        happen because the element may not have been added to DOM yet.
        See https://github.com/ankeetmaini/react-infinite-scroll-component/issues/59 for more info.
      `),null)},e.onStart=function(n){e.lastScrollTop||(e.dragging=!0,n instanceof MouseEvent?e.startY=n.pageY:n instanceof TouchEvent&&(e.startY=n.touches[0].pageY),e.currentY=e.startY,e._infScroll&&(e._infScroll.style.willChange="transform",e._infScroll.style.transition="transform 0.2s cubic-bezier(0,0,0.31,1)"))},e.onMove=function(n){!e.dragging||(n instanceof MouseEvent?e.currentY=n.pageY:n instanceof TouchEvent&&(e.currentY=n.touches[0].pageY),!(e.currentY<e.startY)&&(e.currentY-e.startY>=Number(e.props.pullDownToRefreshThreshold)&&e.setState({pullToRefreshThresholdBreached:!0}),!(e.currentY-e.startY>e.maxPullDownDistance*1.5)&&e._infScroll&&(e._infScroll.style.overflow="visible",e._infScroll.style.transform="translate3d(0px, "+(e.currentY-e.startY)+"px, 0px)")))},e.onEnd=function(){e.startY=0,e.currentY=0,e.dragging=!1,e.state.pullToRefreshThresholdBreached&&(e.props.refreshFunction&&e.props.refreshFunction(),e.setState({pullToRefreshThresholdBreached:!1})),requestAnimationFrame(function(){e._infScroll&&(e._infScroll.style.overflow="auto",e._infScroll.style.transform="none",e._infScroll.style.willChange="unset")})},e.onScrollListener=function(n){typeof e.props.onScroll=="function"&&setTimeout(function(){return e.props.onScroll&&e.props.onScroll(n)},0);var i=e.props.height||e._scrollableNode?n.target:document.documentElement.scrollTop?document.documentElement:document.body;if(!e.actionTriggered){var u=e.props.inverse?e.isElementAtTop(i,e.props.scrollThreshold):e.isElementAtBottom(i,e.props.scrollThreshold);u&&e.props.hasMore&&(e.actionTriggered=!0,e.setState({showLoader:!0}),e.props.next&&e.props.next()),e.lastScrollTop=i.scrollTop}},e.state={showLoader:!1,pullToRefreshThresholdBreached:!1,prevDataLength:l.dataLength},e.throttledOnScrollListener=J(150,e.onScrollListener).bind(e),e.onStart=e.onStart.bind(e),e.onMove=e.onMove.bind(e),e.onEnd=e.onEnd.bind(e),e}return o.prototype.componentDidMount=function(){if(typeof this.props.dataLength=="undefined")throw new Error('mandatory prop "dataLength" is missing. The prop is needed when loading more content. Check README.md for usage');if(this._scrollableNode=this.getScrollableTarget(),this.el=this.props.height?this._infScroll:this._scrollableNode||window,this.el&&this.el.addEventListener("scroll",this.throttledOnScrollListener),typeof this.props.initialScrollY=="number"&&this.el&&this.el instanceof HTMLElement&&this.el.scrollHeight>this.props.initialScrollY&&this.el.scrollTo(0,this.props.initialScrollY),this.props.pullDownToRefresh&&this.el&&(this.el.addEventListener("touchstart",this.onStart),this.el.addEventListener("touchmove",this.onMove),this.el.addEventListener("touchend",this.onEnd),this.el.addEventListener("mousedown",this.onStart),this.el.addEventListener("mousemove",this.onMove),this.el.addEventListener("mouseup",this.onEnd),this.maxPullDownDistance=this._pullDown&&this._pullDown.firstChild&&this._pullDown.firstChild.getBoundingClientRect().height||0,this.forceUpdate(),typeof this.props.refreshFunction!="function"))throw new Error(`Mandatory prop "refreshFunction" missing.
          Pull Down To Refresh functionality will not work
          as expected. Check README.md for usage'`)},o.prototype.componentWillUnmount=function(){this.el&&(this.el.removeEventListener("scroll",this.throttledOnScrollListener),this.props.pullDownToRefresh&&(this.el.removeEventListener("touchstart",this.onStart),this.el.removeEventListener("touchmove",this.onMove),this.el.removeEventListener("touchend",this.onEnd),this.el.removeEventListener("mousedown",this.onStart),this.el.removeEventListener("mousemove",this.onMove),this.el.removeEventListener("mouseup",this.onEnd)))},o.prototype.componentDidUpdate=function(l){this.props.dataLength!==l.dataLength&&(this.actionTriggered=!1,this.setState({showLoader:!1}))},o.getDerivedStateFromProps=function(l,e){var n=l.dataLength!==e.prevDataLength;return n?U(U({},e),{prevDataLength:l.dataLength}):null},o.prototype.isElementAtTop=function(l,e){e===void 0&&(e=.8);var n=l===document.body||l===document.documentElement?window.screen.availHeight:l.clientHeight,i=D(e);return i.unit===B.Pixel?l.scrollTop<=i.value+n-l.scrollHeight+1:l.scrollTop<=i.value/100+n-l.scrollHeight+1},o.prototype.isElementAtBottom=function(l,e){e===void 0&&(e=.8);var n=l===document.body||l===document.documentElement?window.screen.availHeight:l.clientHeight,i=D(e);return i.unit===B.Pixel?l.scrollTop+n>=l.scrollHeight-i.value:l.scrollTop+n>=i.value/100*l.scrollHeight},o.prototype.render=function(){var l=this,e=U({height:this.props.height||"auto",overflow:"auto",WebkitOverflowScrolling:"touch"},this.props.style),n=this.props.hasChildren||!!(this.props.children&&this.props.children instanceof Array&&this.props.children.length),i=this.props.pullDownToRefresh&&this.props.height?{overflow:"auto"}:{};return j.createElement("div",{style:i,className:"infinite-scroll-component__outerdiv"},j.createElement("div",{className:"infinite-scroll-component "+(this.props.className||""),ref:function(u){return l._infScroll=u},style:e},this.props.pullDownToRefresh&&j.createElement("div",{style:{position:"relative"},ref:function(u){return l._pullDown=u}},j.createElement("div",{style:{position:"absolute",left:0,right:0,top:-1*this.maxPullDownDistance}},this.state.pullToRefreshThresholdBreached?this.props.releaseToRefreshContent:this.props.pullDownToRefreshContent)),this.props.children,!this.state.showLoader&&!n&&this.props.hasMore&&this.props.loader,this.state.showLoader&&this.props.hasMore&&this.props.loader,!this.props.hasMore&&this.props.endMessage))},o}(j.Component);N.Z=F}}]);
