(self.webpackChunkidas_ui=self.webpackChunkidas_ui||[]).push([[448],{62448:function(Qe,he,i){"use strict";i.d(he,{L:function(){return Y},b:function(){return V}});var N=i(96156),u=i(28991),b=i(55507),q=i(92137),_=i(85061),T=i(28481),ee=i(81253),re=i(17503),pe=i(92210),ge=i(1977),z=i(48171),Ze=i(11959),H=i(71230),A=i(15746),Fe=i(88182),ne=i(25320),J=i(71577),Se=i(19650),te=i(63202),xe=i(94184),oe=i.n(xe),ye=i(50344),Re=i(21770),s=i(67294),Ce=i(80334),Pe=i(42489),a=i(85893),je=["onFinish","step","formRef","title","stepProps"];function Me(t){var d=(0,s.useRef)(),n=(0,s.useContext)(V),m=t.onFinish,$=t.step,G=t.formRef,Z=t.title,Ee=t.stepProps,P=(0,ee.Z)(t,je);return(0,Ce.ET)(!P.submitter,"StepForm \u4E0D\u5305\u542B\u63D0\u4EA4\u6309\u94AE\uFF0C\u8BF7\u5728 StepsForm \u4E0A"),(0,s.useImperativeHandle)(G,function(){return d.current}),(0,s.useEffect)(function(){if(!!(t.name||t.step)){var e=(t.name||t.step).toString();return n==null||n.regForm(e,t),function(){n==null||n.unRegForm(e)}}},[]),n&&n!==null&&n!==void 0&&n.formArrayRef&&(n.formArrayRef.current[$||0]=d),(0,a.jsx)(Pe.I,(0,u.Z)({formRef:d,onFinish:function(){var e=(0,q.Z)((0,b.Z)().mark(function F(x){var j;return(0,b.Z)().wrap(function(p){for(;;)switch(p.prev=p.next){case 0:if(P.name&&(n==null||n.onFormFinish(P.name,x)),!m){p.next=9;break}return n==null||n.setLoading(!0),p.next=5,m==null?void 0:m(x);case 5:return j=p.sent,j&&(n==null||n.next()),n==null||n.setLoading(!1),p.abrupt("return");case 9:n!=null&&n.lastStep||n==null||n.next();case 10:case"end":return p.stop()}},F)}));return function(F){return e.apply(this,arguments)}}(),layout:"vertical"},P))}var De=Me,be=i(27350),Ae=function(d){return(0,N.Z)({},d.componentCls,{"&-container":{width:"max-content",minWidth:"520px",maxWidth:"100%",margin:"auto"},"&-steps-container":(0,N.Z)({maxWidth:"1160px",margin:"auto"},"".concat(d.antCls,"-steps-vertical"),{height:"100%"}),"&-step":{display:"none",marginBlockStart:"32px","&-active":{display:"block"},"> form":{maxWidth:"100%"}}})};function $e(t){return(0,be.Xj)("StepsForm",function(d){var n=(0,u.Z)((0,u.Z)({},d),{},{componentCls:".".concat(t)});return[Ae(n)]})}var Ie=["current","onCurrentChange","submitter","stepsFormRender","stepsRender","stepFormRender","stepsProps","onFinish","formProps","containerStyle","formRef","formMapRef"],V=s.createContext(void 0),We={horizontal:function(d){var n=d.stepsDom,m=d.formDom;return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(H.Z,{gutter:{xs:8,sm:16,md:24},children:(0,a.jsx)(A.Z,{span:24,children:n})}),(0,a.jsx)(H.Z,{gutter:{xs:8,sm:16,md:24},children:(0,a.jsx)(A.Z,{span:24,children:m})})]})},vertical:function(d){var n=d.stepsDom,m=d.formDom;return(0,a.jsxs)(H.Z,{align:"stretch",wrap:!0,gutter:{xs:8,sm:16,md:24},children:[(0,a.jsx)(A.Z,{xxl:4,xl:6,lg:7,md:8,sm:10,xs:12,children:s.cloneElement(n,{style:{height:"100%"}})}),(0,a.jsx)(A.Z,{children:(0,a.jsx)("div",{style:{display:"flex",alignItems:"center",width:"100%",height:"100%"},children:m})})]})}};function Be(t){var d=(0,s.useContext)(Fe.ZP.ConfigContext),n=d.getPrefixCls,m=n("pro-steps-form"),$=$e(m),G=$.wrapSSR,Z=$.hashId,Ee=t.current,P=t.onCurrentChange,e=t.submitter,F=t.stepsFormRender,x=t.stepsRender,j=t.stepFormRender,g=t.stepsProps,p=t.onFinish,se=t.formProps,ie=t.containerStyle,Le=t.formRef,Ne=t.formMapRef,Te=(0,ee.Z)(t,Ie),X=(0,s.useRef)(new Map),S=(0,s.useRef)(new Map),y=(0,s.useRef)([]),ze=(0,s.useState)([]),ae=(0,T.Z)(ze,2),h=ae[0],ue=ae[1],He=(0,s.useState)(!1),le=(0,T.Z)(He,2),M=le[0],I=le[1],R=(0,re.YB)(),Je=(0,Re.Z)(0,{value:t.current,onChange:t.onCurrentChange}),ve=(0,T.Z)(Je,2),c=ve[0],W=ve[1],K=(0,s.useMemo)(function(){return We[(g==null?void 0:g.direction)||"horizontal"]},[g==null?void 0:g.direction]),O=(0,s.useMemo)(function(){return c===h.length-1},[h.length,c]),Ve=(0,s.useCallback)(function(r,o){S.current.has(r)||ue(function(v){return[].concat((0,_.Z)(v),[r])}),S.current.set(r,o)},[]),Ye=(0,s.useCallback)(function(r){ue(function(o){return o.filter(function(v){return v!==r})}),S.current.delete(r),X.current.delete(r)},[]);(0,s.useImperativeHandle)(Ne,function(){return y.current}),(0,s.useImperativeHandle)(Le,function(){var r;return(r=y.current[c||0])===null||r===void 0?void 0:r.current},[c]);var Ge=(0,s.useCallback)(function(){var r=(0,q.Z)((0,b.Z)().mark(function o(v,l){var D,L;return(0,b.Z)().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:if(X.current.set(v,l),!(!O||!p)){f.next=3;break}return f.abrupt("return");case 3:return I(!0),D=pe.T.apply(void 0,[{}].concat((0,_.Z)(Array.from(X.current.values())))),f.prev=5,f.next=8,p(D);case 8:L=f.sent,L&&(W(0),y.current.forEach(function(Oe){var w;return(w=Oe.current)===null||w===void 0?void 0:w.resetFields()})),f.next=15;break;case 12:f.prev=12,f.t0=f.catch(5),console.log(f.t0);case 15:return f.prev=15,I(!1),f.finish(15);case 18:case"end":return f.stop()}},o,null,[[5,12,15,18]])}));return function(o,v){return r.apply(this,arguments)}}(),[O,p,I,W]),Q=(0,s.useMemo)(function(){var r=(0,ge.n)(Ze.Z,"4.24.0")>-1,o=r?{items:h.map(function(v){var l=S.current.get(v);return(0,u.Z)({key:v,title:l==null?void 0:l.title},l==null?void 0:l.stepProps)})}:{};return(0,a.jsx)("div",{className:"".concat(m,"-steps-container ").concat(Z),style:{maxWidth:Math.min(h.length*320,1160)},children:(0,a.jsx)(ne.Z,(0,u.Z)((0,u.Z)((0,u.Z)({},g),o),{},{current:c,onChange:void 0,children:!r&&h.map(function(v){var l=S.current.get(v);return(0,a.jsx)(ne.Z.Step,(0,u.Z)({title:l==null?void 0:l.title},l==null?void 0:l.stepProps),v)})}))})},[h,Z,m,c,g]),C=(0,z.J)(function(){var r,o=y.current[c];(r=o.current)===null||r===void 0||r.submit()}),B=(0,z.J)(function(){c<1||W(c-1)}),U=(0,s.useMemo)(function(){return e!==!1&&(0,a.jsx)(J.Z,(0,u.Z)((0,u.Z)({type:"primary",loading:M},e==null?void 0:e.submitButtonProps),{},{onClick:function(){var o;e==null||(o=e.onSubmit)===null||o===void 0||o.call(e),C()},children:R.getMessage("stepsForm.next","\u4E0B\u4E00\u6B65")}),"next")},[R,M,C,e]),k=(0,s.useMemo)(function(){return e!==!1&&(0,a.jsx)(J.Z,(0,u.Z)((0,u.Z)({},e==null?void 0:e.resetButtonProps),{},{onClick:function(){var o;B(),e==null||(o=e.onReset)===null||o===void 0||o.call(e)},children:R.getMessage("stepsForm.prev","\u4E0A\u4E00\u6B65")}),"pre")},[R,B,e]),me=(0,s.useMemo)(function(){return e!==!1&&(0,a.jsx)(J.Z,(0,u.Z)((0,u.Z)({type:"primary",loading:M},e==null?void 0:e.submitButtonProps),{},{onClick:function(){var o;e==null||(o=e.onSubmit)===null||o===void 0||o.call(e),C()},children:R.getMessage("stepsForm.submit","\u63D0\u4EA4")}),"submit")},[R,M,C,e]),Xe=(0,z.J)(function(){c>h.length-2||W(c+1)}),E=(0,s.useMemo)(function(){var r=[],o=c||0;if(o<1?r.push(U):o+1===h.length?r.push(k,me):r.push(k,U),r=r.filter(s.isValidElement),e&&e.render){var v,l={form:(v=y.current[c])===null||v===void 0?void 0:v.current,onSubmit:C,step:c,onPre:B};return e.render(l,r)}return e&&(e==null?void 0:e.render)===!1?null:r},[h.length,U,C,k,B,c,me,e]),ce=(0,s.useMemo)(function(){return(0,ye.Z)(t.children).map(function(r,o){var v=r.props,l=v.name||"".concat(o),D=c===o,L=D?{contentRender:j,submitter:!1}:{};return(0,a.jsx)("div",{className:oe()("".concat(m,"-step"),Z,(0,N.Z)({},"".concat(m,"-step-active"),D)),children:s.cloneElement(r,(0,u.Z)((0,u.Z)((0,u.Z)((0,u.Z)({},L),se),v),{},{name:l,step:o,key:l}))},l)})},[se,Z,m,t.children,c,j]),de=(0,s.useMemo)(function(){return x?x(h.map(function(r){var o;return{key:r,title:(o=S.current.get(r))===null||o===void 0?void 0:o.title}}),Q):Q},[h,Q,x]),fe=(0,s.useMemo)(function(){return(0,a.jsxs)("div",{className:"".concat(m,"-container ").concat(Z),style:ie,children:[ce,F?null:(0,a.jsx)(Se.Z,{children:E})]})},[ie,ce,Z,m,F,E]),Ke=(0,s.useMemo)(function(){var r={stepsDom:de,formDom:fe};return F?F(K(r),E):K(r)},[de,fe,K,F,E]);return G((0,a.jsx)("div",{className:oe()(m,Z),children:(0,a.jsx)(te.Z.Provider,(0,u.Z)((0,u.Z)({},Te),{},{children:(0,a.jsx)(V.Provider,{value:{loading:M,setLoading:I,regForm:Ve,keyArray:h,next:Xe,formArrayRef:y,formMapRef:S,lastStep:O,unRegForm:Ye,onFormFinish:Ge},children:Ke})}))}))}function Y(t){return(0,a.jsx)(re._Y,{needDeps:!0,children:(0,a.jsx)(Be,(0,u.Z)({},t))})}Y.StepForm=De,Y.useForm=te.Z.useForm}}]);
