(self.webpackChunkidas_ui=self.webpackChunkidas_ui||[]).push([[258],{33055:function(k){k.exports={container:"container___37JKF",lang:"lang___ODW_o",content:"content___3akJJ",icon:"icon___1ArHE"}},68836:function(k,O,n){"use strict";n.r(O),n.d(O,{default:function(){return We}});var V=n(18106),D=n(58500),R=n(34792),M=n(48086),f=n(91896),c=n(39428),h=n(3182),l=n(2824),d=n(11849),i=n(86582),g=n(93224),L=n(17462),e=n(76772),qe=n(34442),ve=n(50963),he=n(96486),S=n(67294),I=n(21010),ge=n(73727),xe=n(60923),pe=n(45953),je=n(71390),W=n(14300),G=n(89652),re=n(88293),q=n(93400),Ze=n(36108),be=n(48107),Me=n(39464),Se=n(89366),ie=n(2603),we=n(64302),Ne=n(29985),Ce=n(29464),y=n(5966),Ie=n(16434),Be=n(63434),_e=n(57663),ze=n(71577),ea=n(13254),Le=n(14277),ye=n(84059),$e=n(79090),Ee=n(21349),a=n(85893),Oe=function(J){var p=J.parentIntl,B=p===void 0?new q.f("user.settings.security",(0,I.YB)()):p,x=J.token,N=new q.f("mfa",B),H=(0,S.useState)(),$=(0,l.Z)(H,2),r=$[0],z=$[1],_=(0,S.useState)(!1),U=(0,l.Z)(_,2),X=U[0],K=U[1],Q=function(){var E=(0,h.Z)((0,c.Z)().mark(function A(s){return(0,c.Z)().wrap(function(Y){for(;;)switch(Y.prev=Y.next){case 0:z(void 0),K(!0),(0,G.HN)({token:s}).then(function(b){z(b.data)}).finally(function(){K(!1)});case 3:case"end":return Y.stop()}},A)}));return function(s){return E.apply(this,arguments)}}();return(0,S.useEffect)(function(){x&&Q(x)},[x]),(0,a.jsxs)(Ee.Z,{children:[(0,a.jsx)("span",{children:(0,a.jsx)(e.Z,{style:{marginBottom:24},message:N.t("code-description","Please obtain two consecutive one-time passwords after scanning and adding MFA and enter them into the input box below."),type:"info",showIcon:!0})}),(0,a.jsxs)("div",{style:{display:"flex"},children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{style:{width:220,height:140},children:r!=null&&r.secret?(0,a.jsx)(ye.Qd,{style:{marginLeft:"40px"},value:r==null?void 0:r.secret}):(0,a.jsx)(Le.Z,{description:"",style:{width:200,height:128},image:X?(0,a.jsx)($e.Z,{}):void 0})}),(0,a.jsx)("div",{style:{display:"grid",width:"100%"},children:(0,a.jsx)(ze.Z,{onClick:function(){x&&Q(x)},type:"link",children:N.t("refresh","Refresh")})})]}),(0,a.jsxs)("div",{style:{marginLeft:"50px"},children:[(0,a.jsx)(y.Z,{hidden:!0,width:"sm",name:"token",fieldProps:{value:r==null?void 0:r.token}}),(0,a.jsx)(y.Z,{rules:[{pattern:/[0-9]{6}/,required:!0}],width:"sm",name:"firstCode",label:N.t("first-code","First code")}),(0,a.jsx)(y.Z,{rules:[{pattern:/[0-9]{6}/,required:!0}],width:"sm",name:"secondCode",label:N.t("second-code","Second code")})]})]})]})},Ve=n(33055),Z=n.n(Ve),De=["children","allows","loginType","hidden"],F=function(p){var B=p.content,x=p.hidden;return x?null:(0,a.jsx)(e.Z,{style:{marginBottom:24},message:B,type:"error",showIcon:!0})},w=function(p){var B=p.children,x=p.allows,N=p.loginType,H=p.hidden,$=(0,g.Z)(p,De),r=new Set([].concat((0,i.Z)(x),[x.map(function(z){return W.Bz[z]})]));return r.has(N)?(0,a.jsx)("span",(0,d.Z)((0,d.Z)({hidden:H},$),{},{children:B})):(0,a.jsx)(a.Fragment,{})},Re=function(){var p=(0,S.useState)({success:!0}),B=(0,l.Z)(p,2),x=B[0],N=B[1],H=(0,S.useState)("normal"),$=(0,l.Z)(H,2),r=$[0],z=$[1],_=(0,S.useState)(),U=(0,l.Z)(_,2),X=U[0],K=U[1],Q=(0,I.tT)("@@initialState"),E=Q.initialState,A=Q.setInitialState,s=new q.f("pages.login",(0,I.YB)()),oe=(0,ve.cI)(),Y=(0,l.Z)(oe,1),b=Y[0],le=["normal","email","sms"],Je=["mfa_totp","mfa_email","mfa_sms"],He=(0,S.useState)(le.map(function(v){return W.Bz[v]})),ce=(0,l.Z)(He,2),ee=ce[0],Ue=ce[1],Ke=function(o){(0,he.isNumber)(o)?z(W.Bz[o]):z(o)},Qe=function(){var v=(0,h.Z)((0,c.Z)().mark(function o(){var m,j;return(0,c.Z)().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,E==null||(m=E.fetchUserInfo)===null||m===void 0?void 0:m.call(E);case 2:if(j=t.sent,!j){t.next=6;break}return t.next=6,A(function(T){return(0,d.Z)((0,d.Z)({},T),{},{currentUser:j})});case 6:case"end":return t.stop()}},o)}));return function(){return v.apply(this,arguments)}}(),Ye=(0,S.useState)(!1),ue=(0,l.Z)(Ye,2),ke=ue[0],Fe=ue[1],Xe=function(){var v=(0,h.Z)((0,c.Z)().mark(function o(m){var j,C,t,T,me,ne,fe,te,se;return(0,c.Z)().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return j=(0,f.Z)({},m),u.prev=1,u.next=4,(0,G.n$)((0,d.Z)((0,d.Z)({},j),{},{type:r,token:X}),{skipErrorHandler:!0});case 4:if(t=u.sent,!((C=t.data)!==null&&C!==void 0&&C.nextMethod&&t.data.nextMethod.length>0)){u.next=12;break}Ue(t.data.nextMethod),Ke(t.data.nextMethod[0]),Fe(!0),K(t.data.token),u.next=29;break;case 12:if(!t.success){u.next=28;break}return T=s.t("success","Login succeeded!"),M.default.success(T),u.next=17,Qe();case 17:if(I.m8){u.next=19;break}return u.abrupt("return");case 19:if(me=I.m8.location.query,ne=me,fe=ne.redirect,te=ne.redirect_uri,!te){u.next=24;break}return window.location.href=te,u.abrupt("return");case 24:return I.m8.push(fe||"/"),u.abrupt("return");case 28:t.errorCode==="E0004"&&(M.default.warning(s.t("".concat((se=t.errorCode)!==null&&se!==void 0?se:"normal",".errorMessage"),t.errorMessage)),I.m8.push("/account/resetPassword?username=".concat(j.username)));case 29:N(t),u.next=35;break;case 32:u.prev=32,u.t0=u.catch(1),N({success:!1});case 35:case"end":return u.stop()}},o,null,[[1,32]])}));return function(m){return v.apply(this,arguments)}}(),P=x.success,Ae=x.errorMessage,ae=x.errorCode,Pe=(0,S.useState)((0,re.MM)(W.Bz,s,"loginType",function(v){return le.includes(v)})),de=(0,l.Z)(Pe,2),Te=de[0],Ge=de[1];return(0,S.useEffect)(function(){Ge((0,re.MM)(W.Bz,s,"loginType",function(v,o){return ee.includes(v)||ee.includes(o)}))},[ee]),(0,a.jsxs)("div",{className:Z().container,children:[(0,a.jsx)("div",{className:Z().lang,"data-lang":!0,children:I.pD&&(0,a.jsx)(I.pD,{})}),(0,a.jsx)("div",{className:Z().content,children:(0,a.jsxs)(Ce.U,{logo:(0,a.jsx)("img",{alt:"logo",src:window.publicPath+"logo.svg"}),title:xe.Z.title,subTitle:(0,a.jsx)(a.Fragment,{children:" "}),initialValues:{autoLogin:!0},form:b,actions:[(0,a.jsx)("span",{children:s.t("loginWith","Other login methods")},"loginWith"),(0,a.jsx)(Ze.Z,{className:Z().icon},"AlipayCircleOutlined"),(0,a.jsx)(be.Z,{className:Z().icon},"TaobaoCircleOutlined"),(0,a.jsx)(Me.Z,{className:Z().icon},"WeiboCircleOutlined")],onFinish:function(){var v=(0,h.Z)((0,c.Z)().mark(function o(m){return(0,c.Z)().wrap(function(C){for(;;)switch(C.prev=C.next){case 0:return C.next=2,Xe(m);case 2:case"end":return C.stop()}},o)}));return function(o){return v.apply(this,arguments)}}(),children:[(0,a.jsx)(D.Z,{activeKey:r,onChange:function(o){z(o),N({success:!0})},items:Te,centered:!0}),(0,a.jsxs)(w,{hidden:ke,loginType:r,allows:["normal"].concat(Je),children:[(0,a.jsx)(F,{hidden:P,content:s.t("".concat(ae??"normal",".errorMessage"),Ae)}),(0,a.jsx)(y.Z,{name:"username",fieldProps:{size:"large",prefix:(0,a.jsx)(Se.Z,{className:Z().prefixIcon})},placeholder:s.t("username.placeholder","Please enter a username"),rules:[{required:!0,message:s.t("username.required","Please enter a username!")}]}),(0,a.jsx)(y.Z.Password,{name:"password",fieldProps:{size:"large",prefix:(0,a.jsx)(ie.Z,{className:Z().prefixIcon})},placeholder:s.t("password.placeholder","Please input a password"),rules:[{required:!0,message:s.t("password.required","Please input a password!")}]})]}),(0,a.jsx)(w,{loginType:r,allows:["mfa_totp"],children:(0,a.jsx)(F,{hidden:P,content:s.t("totp.errorMessage","verification code error")})}),(0,a.jsxs)(w,{loginType:r,allows:["email","mfa_email"],children:[(0,a.jsx)(F,{hidden:P,content:s.t("email.errorMessage","Email verification code error")}),(0,a.jsx)(y.Z,{fieldProps:{size:"large",prefix:(0,a.jsx)(we.Z,{className:Z().prefixIcon})},name:"email",placeholder:s.t("email.placeholder","Please enter your email"),rules:[{required:!0,message:s.t("email.required","Please enter your email!")}]})]}),(0,a.jsxs)(w,{loginType:r,allows:["sms","mfa_sms"],children:[(0,a.jsx)(F,{hidden:P,content:s.t("sms.errorMessage","SMS verification code error")}),(0,a.jsx)(y.Z,{fieldProps:{size:"large",prefix:(0,a.jsx)(Ne.Z,{className:Z().prefixIcon})},name:"phone",placeholder:s.t("phoneNumber.placeholder","Please enter your phone number"),rules:[{required:!0,message:s.t("phoneNumber.required","Please enter your phone number!")},{pattern:/^1\d{10}$/,message:s.t("phoneNumber.invalid","Mobile phone number format error!")}]})]}),(0,a.jsx)(w,{loginType:r,allows:["sms","mfa_sms","mfa_email","email","mfa_totp"],children:(0,a.jsx)(Ie.Z,{fieldProps:{size:"large",prefix:(0,a.jsx)(ie.Z,{className:Z().prefixIcon})},captchaProps:{size:"large",hidden:r==="mfa_totp"},placeholder:s.t("captcha.placeholder","Please enter the verification code"),captchaTextRender:function(o,m){return o?"".concat(m," ").concat(s.t("getCaptchaSecondText","Get verification code")):s.t("phone.getVerificationCode","Get verification code")},name:"code",rules:[{required:!0,message:s.t("captcha.required","Please enter the verification code!")}],onGetCaptcha:(0,h.Z)((0,c.Z)().mark(function v(){var o,m,j;return(0,c.Z)().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:m={type:r},t.t0=r,t.next=t.t0==="mfa_email"?4:t.t0==="email"?6:t.t0==="mfa_sms"?9:t.t0==="sms"?11:13;break;case 4:b.validateFields(["username"]),m.username=b.getFieldValue("username");case 6:return b.validateFields(["email"]),m.email=b.getFieldValue("email"),t.abrupt("break",14);case 9:b.validateFields(["username"]),m.username=b.getFieldValue("username");case 11:b.validateFields(["phone"]),m.phone=b.getFieldValue("phone");case 13:return t.abrupt("break",14);case 14:return t.next=16,(0,G.Do)(m);case 16:if(j=t.sent,j.success){t.next=19;break}return t.abrupt("return");case 19:K((o=j.data)===null||o===void 0?void 0:o.token),M.default.success("Verification code sent successfully.");case 21:case"end":return t.stop()}},v)}))})}),(0,a.jsx)(w,{loginType:r,allows:["enable_mfa_email","enable_mfa_sms","enable_mfa_totp"],style:{width:550,display:"block",transform:"translate(-75px)"},children:(0,a.jsx)(e.Z,{style:{marginBottom:24},message:s.t("mfa.errorMessage","Because your user is set to enable multiple factor authentication (MFA), you need to enable at least one MFA authentication method."),type:"info",showIcon:!0})}),(0,a.jsx)(w,{loginType:r,allows:["enable_mfa_sms"],style:{width:550,display:"block",transform:"translate(-75px)"},children:(0,a.jsx)(e.Z,{style:{marginBottom:24},message:s.t("enableMfa.smsMessage","Click Login to automatically enable email as the second authentication factor."),type:"info",showIcon:!0})}),(0,a.jsx)(w,{loginType:r,allows:["enable_mfa_email"],style:{width:550,display:"block",transform:"translate(-75px)"},children:(0,a.jsx)(e.Z,{style:{marginBottom:24},message:s.t("enableMfa.emailMessage","Click Login to automatically enable email as the second authentication factor."),type:"info",showIcon:!0})}),(0,a.jsx)(w,{style:{width:550,display:"block",transform:"translate(-75px)"},loginType:r,allows:["enable_mfa_totp"],children:(0,a.jsx)(Oe,{token:X})}),(0,a.jsxs)("div",{style:{marginBottom:24},children:[(0,a.jsx)(Be.Z,{noStyle:!0,name:"autoLogin",children:s.t("rememberMe","Automatic login")}),(0,a.jsx)(w,{loginType:r,allows:["normal"],children:(0,a.jsx)(ge.rU,{style:{float:"right"},to:pe.A,children:s.t("forgotPassword","Forgot password")})})]})]})}),(0,a.jsx)(je.Z,{})]})},We=Re},14300:function(k,O,n){"use strict";n.d(O,{FI:function(){return V},Bz:function(){return M},w$:function(){return c},qJ:function(){return h},FQ:function(){return l},J0:function(){return i}});var V;(function(e){e[e.unsafe=0]="unsafe",e[e.general=1]="general",e[e.safe=2]="safe",e[e.very_safe=3]="very_safe"})(V||(V={}));var D;(function(e){e[e.refresh_token=0]="refresh_token",e[e.authorization_code=1]="authorization_code",e[e.password=2]="password",e[e.client_credentials=3]="client_credentials"})(D||(D={}));var R;(function(e){e[e.default=0]="default",e[e.code=1]="code",e[e.token=2]="token"})(R||(R={}));var M;(function(e){e[e.enable_mfa_totp=10]="enable_mfa_totp",e[e.enable_mfa_email=11]="enable_mfa_email",e[e.enable_mfa_sms=12]="enable_mfa_sms",e[e.normal=0]="normal",e[e.mfa_totp=1]="mfa_totp",e[e.mfa_email=2]="mfa_email",e[e.mfa_sms=3]="mfa_sms",e[e.sms=5]="sms",e[e.email=4]="email"})(M||(M={}));var f;(function(e){e[e.basic=0]="basic",e[e.signature=1]="signature",e[e.token=2]="token",e[e.token_signature=3]="token_signature"})(f||(f={}));var c;(function(e){e[e.unknown=0]="unknown",e[e.normal=1]="normal",e[e.disable=2]="disable"})(c||(c={}));var h;(function(e){e[e.oidc=32]="oidc",e[e.none=0]="none",e[e.authorization_code=1]="authorization_code",e[e.implicit=2]="implicit",e[e.password=4]="password",e[e.client_credentials=8]="client_credentials",e[e.proxy=16]="proxy"})(h||(h={}));var l;(function(e){e[e.manual=0]="manual",e[e.full=1]="full"})(l||(l={}));var d;(function(e){e[e.system=1]="system",e[e.user=0]="user"})(d||(d={}));var i;(function(e){e[e.normal=0]="normal",e[e.disabled=1]="disabled",e[e.user_inactive=2]="user_inactive",e[e.password_expired=4]="password_expired"})(i||(i={}));var g;(function(e){e[e.text=0]="text",e[e.date=11]="date",e[e.dateTimeRange=14]="dateTimeRange",e[e.radio=6]="radio",e[e.multiSelect=9]="multiSelect",e[e.timeRange=10]="timeRange",e[e.dateRange=12]="dateRange",e[e.checkbox=5]="checkbox",e[e.switch=7]="switch",e[e.select=8]="select",e[e.textarea=2]="textarea",e[e.digit=3]="digit",e[e.digitRange=4]="digitRange",e[e.dateTime=13]="dateTime"})(g||(g={}));var L;(function(e){e[e.all=0]="all",e[e.disabled=1]="disabled",e[e.enabled=2]="enabled"})(L||(L={}))},88293:function(k,O,n){"use strict";n.d(O,{MM:function(){return V},fs:function(){return D},GG:function(){return R}});var V=function(f,c,h,l){var d=[];for(var i in f)if(Object.prototype.propertyIsEnumerable.call(f,i)&&isNaN(Number(i))){var g=f[i];if(l&&!l(i,g))continue;d.push({label:c.formatMessage({id:"".concat(h,".").concat(i),defaultMessage:i}),key:i,value:g})}return d},D=function(f,c,h,l){var d=new Map;for(var i in f)if(Object.prototype.hasOwnProperty.call(f,i)&&isNaN(Number(i))){var g=f[i];if(l&&!l(i,g))continue;d.set(g,c.formatMessage({id:"".concat(h,".").concat(i),defaultMessage:i}))}return d},R=function(f,c,h,l){var d={};for(var i in f)if(Object.prototype.hasOwnProperty.call(f,i)&&!isNaN(Number(i))){var g,L=f[i];d[i]={text:c.formatMessage({id:"".concat(h,".").concat(L),defaultMessage:L}),status:(g=l[L])!==null&&g!==void 0?g:"Default"}}return d}}}]);
